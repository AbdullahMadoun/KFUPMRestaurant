{
  "device": "cuda",
  "output_dir": "batch_results_v2_test2",
  "sam3_repo_path": "sam3",
  "image_extensions": [
    "*.jpg",
    "*.jpeg",
    "*.png",
    "*.bmp",
    "*.webp"
  ],
  "vlm": {
    "model_name": "Qwen/Qwen3-VL-8B-Instruct",
    "gpu_memory_utilization": 0.85,
    "max_model_len": 4096,
    "enforce_eager": false,
    "enable_prefix_caching": true,
    "allowed_local_media_path": "/workspace/KFUPMRestaurant",
    "temperature": 0.3,
    "max_tokens": 768,
    "top_p": 0.8,
    "top_k": 20,
    "system_prompt": "You are a food visual analyzer. You describe exactly what you see in images \u2014 colors, textures, shapes, positions. You never guess food names. You output only valid JSON.",
    "describe_template": "Look at this cafeteria plate and identify every distinct food portion.\n\nFor EACH portion, describe ONLY what your eyes see:\n- Main color(s) and any color variations\n- Surface texture (glossy, matte, grainy, smooth, rough, flaky)\n- Shape and form (mound, flat spread, scattered pieces, slices, chunks, strips)\n- Position on plate (left, right, center, top, bottom)\n- Relative size (fraction of plate area)\n\nGROUPING RULES:\n- Multiple scattered pieces of the SAME food = ONE item with ONE bbox around all of them\n  (e.g. several small chunks spread across a region = single item, single bbox)\n- A mixed dish (salad, stew, stir-fry with mixed ingredients) = ONE item\n- Visually DIFFERENT foods that touch or overlap = SEPARATE items\n- Same food in clearly separated areas with a visible gap = SEPARATE items\n- Small garnishes (lemon slice, herbs) = separate item only if clearly visible\n\nCount carefully. Cafeteria plates typically have 1-5 portions but do NOT default to any specific number. Count what you actually see.\n\nReturn strictly as JSON:\n{\"items\": [\n  {\"description\": \"<main_colors> <surface_texture> <shape_and_form>, <position_on_plate>\", \"bbox\": [x1, y1, x2, y2]},\n  ...\n]}\n\nThe description template above shows the FORMAT \u2014 you MUST replace every <placeholder> with actual visual details from THIS specific image. Never output angle brackets or placeholder text.\nBounding boxes are pixel coordinates [x1, y1, x2, y2] tightly fitting each item.\nReturn ONLY the JSON, no other text."
  },
  "sam": {
    "model_path": "facebook/sam3",
    "confidence_threshold": 0.15,
    "fallback_thresholds": [
      0.05,
      0.02,
      0.01
    ],
    "crop_padding": 10,
    "bpe_search_paths": [
      "/root/sam3/sam3/assets/bpe_simple_vocab_16e6.txt.gz"
    ],
    "multi_box_prompt": false,
    "multi_box_grid": 2
  },
  "match": {
    "embedding_model": "google/siglip2-base-patch16-224",
    "embedding_dim": 768,
    "index_path": "menu.index",
    "metadata_path": "menu_meta.json",
    "top_k": 3,
    "similarity_threshold": 0.5,
    "text_weight": 0.3,
    "use_text_matching": true
  },
  "nms": {
    "max_objects": 8,
    "iou_threshold": 0.7
  },
  "viz": {
    "draw_boxes": true,
    "alpha": 0.7,
    "thickness": 3,
    "font_scale": 0.9,
    "font_thickness": 2,
    "show_match_label": true,
    "show_price": true,
    "show_confidence": true,
    "color_low": [
      0,
      50
    ],
    "color_high": [
      180,
      255
    ]
  }
}