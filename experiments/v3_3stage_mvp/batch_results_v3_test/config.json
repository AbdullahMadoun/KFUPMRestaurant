{
  "device": "cuda",
  "output_dir": "batch_results_v3_test",
  "sam3_repo_path": "sam3",
  "image_extensions": [
    "*.jpg",
    "*.jpeg",
    "*.png",
    "*.bmp",
    "*.webp"
  ],
  "vlm": {
    "model_name": "Qwen/Qwen3-VL-8B-Instruct",
    "gpu_memory_utilization": 0.85,
    "max_model_len": 4096,
    "enforce_eager": false,
    "enable_prefix_caching": true,
    "allowed_local_media_path": "/workspace/KFUPMRestaurant",
    "temperature": 0.3,
    "max_tokens": 768,
    "top_p": 0.8,
    "top_k": 20,
    "system_prompt": "You are a food visual analyzer. You describe exactly what you see in images \u2014 colors, textures, shapes, positions. You never guess food names. You output only valid JSON.",
    "describe_template": "Look at this cafeteria plate and identify every distinct food portion.\n\nFor EACH portion provide:\n- description: short visual description (~10 words) \u2014 colors, texture, shape\n- bbox: tight bounding box [x1, y1, x2, y2] in pixel coordinates\n- points: 2-3 pixel coordinates [x, y] placed directly ON the food surface. Pick points that are clearly on the food, spread across the region.\n\nGROUPING RULES:\n- Scattered pieces of the SAME food = ONE item, ONE bbox around ALL pieces\n- A mixed dish (salad, stew, stir-fry) = ONE item\n- Visually DIFFERENT foods that touch = SEPARATE items\n- Same food in clearly separated areas = SEPARATE items\n\nCount what you actually see. Do NOT default to any number.\n\nReturn strictly as JSON:\n{\"items\": [\n  {\"description\": \"<colors> <texture> <shape>\", \"bbox\": [x1, y1, x2, y2], \"points\": [[px1, py1], [px2, py2]]},\n  ...\n]}\n\nReplace <placeholders> with actual observations. All coordinates are pixel values. Return ONLY the JSON."
  },
  "sam": {
    "model_path": "facebook/sam3",
    "confidence_threshold": 0.1,
    "fallback_thresholds": [
      0.05,
      0.02,
      0.01
    ],
    "crop_padding": 10,
    "bpe_search_paths": [
      "/root/sam3/sam3/assets/bpe_simple_vocab_16e6.txt.gz"
    ],
    "multi_box_prompt": false,
    "multi_box_grid": 2,
    "use_vlm_points": true
  },
  "match": {
    "embedding_model": "google/siglip2-base-patch16-224",
    "embedding_dim": 768,
    "index_path": "menu.index",
    "metadata_path": "menu_meta.json",
    "top_k": 3,
    "similarity_threshold": 0.5,
    "text_weight": 0.3,
    "use_text_matching": true
  },
  "nms": {
    "max_objects": 8,
    "iou_threshold": 0.7
  },
  "viz": {
    "draw_boxes": true,
    "alpha": 0.7,
    "thickness": 3,
    "font_scale": 0.9,
    "font_thickness": 2,
    "show_match_label": true,
    "show_price": true,
    "show_confidence": true,
    "color_low": [
      0,
      50
    ],
    "color_high": [
      180,
      255
    ]
  }
}